# Software 
- R 4.3.1
- [plink 2.0](https://www.cog-genomics.org/plink/2.0/)

### GTEx

Use list of genes to get TPM data from GTEx v8
- Download GTEx v8 gct file: GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_tpm.gct 
	- Bulk tissue expression: https://www.gtexportal.org/home/downloads/adult-gtex/bulk_tissue_expression
- Gene lists from San Roman et. al.(1) Table S7
	- allNPX.txt
	- allPAR1.txt
- Run gene_filter_tacc.py 
- Output files
	- geneNPX_tpm_allsamples.txt
	- genePAR1_tpm_allsamples.txt

Filter and format data to include tissue and sex metadata, and remove male or female only tissues
- Download GTEx v8 sample attributes files
  - GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt
	- GTEx_Analysis_v8_Annotations_SubjectPhenotypesDS.txt
	- Metadata: https://www.gtexportal.org/home/downloads/adult-gtex/metadata
- Run format_TPM.R
	- Inputs: geneNPX_tpm_allsamples.txt and genePAR1_tpm_allsamples.txt
	- Outputs: geneNPX_TPM_filtered.txt and genePAR1_TPM_filtered.txt

Get female - male difference between median TPM per tissue per gene
- Run median_sex_TPM.R
	- Inputs: geneNPX_TPM_filtered.txt and genePAR1_TPM_filtered.txt
	- Outputs: meddiff_SMTSD_NPXgene.txt and meddiff_SMTSD_PAR1gene.txt

Figures 1; S2
Plot M-F median TPM difference against ASE
- Allele-specific expression data from Tukiainen et. al.(2) Table S5 
	- Input: Suppl.Table.5.ASE.txt
- Run Fig1_FMgene_ase.R
	- Inputs: meddiff_SMTSD_NPXgene.txt and meddiff_SMTSD_PAR1gene.txt and allNPX.txt
	- Outputs: Figures and ASE_tissue.txt
	- Specify tissue name in line 86

####### Figure 2
Plot phenotype values against alleles

Figure S1
SD ASE and Gene Expression Across Tissues
- Run 

### XWAS

Quality Check 
- Run QC_X.sh
	- Inputs listed as datafields in script, requires UKBB access

Phenotypes
- Requires UKBB access
- Label as pheno_[pheno_name].txt
- 3 columns: #FID	IID	[pheno_name]

Perform XWAS using additive and dominance deviation models
- Run XWAS.sh -p [pheno_name]
- XWAS files uploaded on #######

Get gene name associated with variant
- Run biomart.R
	- Input: gene_id_list.txt, gene_list.txt
	- Output: ensemblGene_name_rsid.txt

Figures 3A,B; S4
Plot XWAS p-values against Xi expression by tissue
- Run XWAS_ASE.R
- Inputs
	- Xi expression data: XWAS summary statistics, ASE_tissue.txt, ensemblGene_name_rsid.txt
- Parameters - change as needed:
	- Line 32: phenotype [pheno_name] Ex. "lymphocyte_perc"
	- Line 33: phenotype label [pheno_label] Ex. "Lymphocyte Percentage"
	- Line 34: T if categorical trait, F if continuous
	- Line 129: Tissue name for tissue-specific plots

Figure 3C
Create heatmap of XWAS p-values for each tissue and trait
- Run Fig3_heatmap.R
- Inputs
	- Correlation between strength of GWAS association and ASE, allPheno_ase_bytissue.txt
		- generated by merging [pheno_name]_ase_bytissue.txt from XWAS_ASE.R
	- ASE_tissue.txt

	


References:
1. San Roman
2. Tukiainen

